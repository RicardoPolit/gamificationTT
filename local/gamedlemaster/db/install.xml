<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="local/gamedlemaster/db" VERSION="20190422" COMMENT="Prueba de concepto para la creacion de los XML"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../../../lib/xmldb/xmldb.xsd"
>
  <TABLES>
    <TABLE NAME="gmdl_usuario" COMMENT="Aqui se guarda toa la informacion del usuario">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="mdl_id_usuario" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="La referencia al usuario de moodle"/>
        <FIELD NAME="nivel_actual" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="1" SEQUENCE="false" COMMENT="Nivel actual del usuario"/>
        <FIELD NAME="experiencia_actual" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="La experiencia que lleva del nivel  n el usuario"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="mdl_id_usuario" TYPE="unique" FIELDS="mdl_id_usuario"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="gmdl_alumno" COMMENT="Un usuario se conviete en alumno, cuando cursa un curso">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="gmdl_id_usuario" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia a la tabla gmdl_usuario"/>
        <FIELD NAME="mdl_id_curso" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia a la tabla gmdl_curso"/>
        <FIELD NAME="experiencia_total_recibida" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Experiencia que ha recibido el usuario a lo largo del curso"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="gmdl_id_usuario" TYPE="foreign" FIELDS="gmdl_id_usuario" REFTABLE="gmdl_usuario" REFFIELDS="mdl_id_usuario"/>
        <KEY NAME="mdl_id_curso" TYPE="foreign" FIELDS="mdl_id_curso" REFTABLE="course" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="gmdl_id_usuario-mdl_id_curso" UNIQUE="true" FIELDS="gmdl_id_usuario, mdl_id_curso"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="gmdl_nivel_categoria_curso" COMMENT="Nivel que tiene un usuario en un tipo de curso">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="nivel_actual" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="1" SEQUENCE="false" COMMENT="Numero entero positivo que indica el nivel actual del alumno"/>
        <FIELD NAME="experiencia_actual" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="La experiencia actual del nivel actual del alumno"/>
        <FIELD NAME="gmdl_id_usuario" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia a nuestra tabala usuario"/>
        <FIELD NAME="mdl_id_categoria_curso" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="gmdl_id_usuario" TYPE="foreign" FIELDS="gmdl_id_usuario" REFTABLE="gmdl_usuario" REFFIELDS="mdl_id_usuario"/>
        <KEY NAME="mdl_id_categoria_curso" TYPE="foreign" FIELDS="mdl_id_categoria_curso" REFTABLE="course_categories" REFFIELDS="id" COMMENT="Referencia a la tabla mdl_course_categories"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="gmdl_id_usuario-mdl_id_categoria_curso" UNIQUE="true" FIELDS="gmdl_id_usuario, mdl_id_categoria_curso"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="gmdl_rango_nivel" COMMENT="Especializacion de rangos de lo niveles">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="nombre" TYPE="char" LENGTH="60" NOTNULL="true" DEFAULT="Los mejores" SEQUENCE="false" COMMENT="Nombre que recibiran los niveles dentro del rango"/>
        <FIELD NAME="nivel_inferior" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Limite cerrado inferior del nivel que debe de tener el alumno"/>
        <FIELD NAME="nivel_superior" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="Limite cerrado superior del nivel que debe tener el alumno"/>
        <FIELD NAME="imagen" TYPE="char" LENGTH="150" NOTNULL="true" DEFAULT="./" SEQUENCE="false" COMMENT="ruta donde se guardara la imagen del usuario"/>
        <FIELD NAME="mensaje" TYPE="char" LENGTH="50" NOTNULL="true" DEFAULT="Eres el mejor, bien hecho!" SEQUENCE="false" COMMENT="Mensaje que se le mostrara al usuario al subir a un nivel dentro de ese rango"/>
        <FIELD NAME="descripcion" TYPE="char" LENGTH="200" NOTNULL="true" DEFAULT="Los niveles son infinitos, o crees poderme demostrar lo contrario?" SEQUENCE="false" COMMENT="Una descripcion para el rango"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="gmdl_condicion" COMMENT="Condicion que se usa para desbloquear logros, estas pueden ser usadas por diversos logros y asÃ­ no se repetirian">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="tabla" TYPE="char" LENGTH="50" NOTNULL="true" SEQUENCE="false" COMMENT="tabla a checar para saber si la condicion se cumplio"/>
        <FIELD NAME="atributo" TYPE="char" LENGTH="30" NOTNULL="true" SEQUENCE="false" COMMENT="Atributo a checar de la tabla asignada, para ver si la condicion se cumple"/>
        <FIELD NAME="expresion" TYPE="char" LENGTH="50" NOTNULL="true" DEFAULT="count(x)" SEQUENCE="false" COMMENT="Expresion que nos indica omo comparar el/los valores del atributo con el valor indicado"/>
        <FIELD NAME="valor" TYPE="char" LENGTH="45" NOTNULL="true" SEQUENCE="false" COMMENT="Valor indicativo para la comparacion"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
    </TABLE>
    <TABLE NAME="gmdl_logro" COMMENT="Caraceristicas del logro visibles para el alumno">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="modulo" TYPE="char" LENGTH="15" NOTNULL="true" SEQUENCE="false" COMMENT="Refrencia  nuestra tabla componente"/>
        <FIELD NAME="icono" TYPE="char" LENGTH="100" NOTNULL="true" DEFAULT="./" SEQUENCE="false" COMMENT="ruta al icono del logro"/>
        <FIELD NAME="nombre" TYPE="char" LENGTH="50" NOTNULL="true" DEFAULT="El logro" SEQUENCE="false" COMMENT="Nombre identificativo al logro para el usuario"/>
        <FIELD NAME="descripcion" TYPE="char" LENGTH="140" NOTNULL="true" DEFAULT="Has algo!" SEQUENCE="false" COMMENT="Texto que le indica al usuario como desbloquear el logro"/>
        <FIELD NAME="experiencia_de_logro" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="100" SEQUENCE="false" COMMENT="La experiencia que otorgara el logro al ser desbloqueado"/>
        <FIELD NAME="tipo" TYPE="char" LENGTH="1" NOTNULL="true" DEFAULT="A" SEQUENCE="false" COMMENT="Que tipo de logro es. SI a nivel curso o plataforma y si es una advertencia o un logro normal"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="nombre" UNIQUE="true" FIELDS="nombre"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="gmdl_evento" COMMENT="Eventos que por el momento nos indican que logros pueden llegar a desbloquear">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="nombre_evento" TYPE="char" LENGTH="100" NOTNULL="true" SEQUENCE="false" COMMENT="Nombre del evento"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="nombre_evento" UNIQUE="true" FIELDS="nombre_evento"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="gmdl_evento_logro" COMMENT="Evento que puede desbloquear el logro indicado">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="gmdl_id_logro" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia a nuestra tabla logro"/>
        <FIELD NAME="gmdl_id_evento" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia a la tabla evento"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="gmdl_id_logro" TYPE="foreign" FIELDS="gmdl_id_logro" REFTABLE="gmdl_logro" REFFIELDS="id"/>
        <KEY NAME="gmdl_id_evento" TYPE="foreign" FIELDS="gmdl_id_evento" REFTABLE="gmdl_evento" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="gmdl_id_evento-gmdl_id_logro" UNIQUE="true" FIELDS="gmdl_id_evento, gmdl_id_logro"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="gmdl_condicion_logro" COMMENT="Relacion que une al logro con sus condiciones">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="gmdl_id_logro" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia a nuestra tabla logro"/>
        <FIELD NAME="gmdl_id_condicion" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia a nuestra tabla de condiciones"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="gmdl_id_logro" TYPE="foreign" FIELDS="gmdl_id_logro" REFTABLE="gmdl_logro" REFFIELDS="id"/>
        <KEY NAME="gmdl_id_condicion" TYPE="foreign" FIELDS="gmdl_id_condicion" REFTABLE="gmdl_condicion" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="gmdl_id_logro-gmdl_id_condicion" UNIQUE="true" FIELDS="gmdl_id_logro, gmdl_id_condicion"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="gmdl_usuario_logro_curso" COMMENT="Bitacora que ve que logros ya desbloqueo o que no ha desbloqueado el usuaio">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="gmdl_id_usuario" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia a nuestra tabla usuario"/>
        <FIELD NAME="gmdl_id_logro" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia  a  nuestra tabla de logro"/>
        <FIELD NAME="mdl_id_curso" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false"/>
        <FIELD NAME="cuando" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="fecha de cuando se obtuvo este logro"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="gmdl_id_usuario" TYPE="foreign" FIELDS="gmdl_id_usuario" REFTABLE="gmdl_usuario" REFFIELDS="mdl_id_usuario"/>
        <KEY NAME="gmdl_id_logro" TYPE="foreign" FIELDS="gmdl_id_logro" REFTABLE="gmdl_logro" REFFIELDS="id"/>
        <KEY NAME="mdl_id_curso" TYPE="foreign" FIELDS="mdl_id_curso" REFTABLE="course" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="gmdl_id_usuario-gmdl_id_logro-mdl_id_curso" UNIQUE="true" FIELDS="gmdl_id_usuario, gmdl_id_logro, mdl_id_curso"/>
      </INDEXES>
    </TABLE>
    <TABLE NAME="gmdl_usuario_logro_global" COMMENT="Aqui se guardan todos los logros globales desboqueados">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="gmdl_id_usuario" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia a nuestra tabla usuario"/>
        <FIELD NAME="gmdl_id_logro" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Referencia  a  nuestra tabla de logro"/>
        <FIELD NAME="cuando" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="fecha de cuando se obtuvo este logro"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="gmdl_id_usuario" TYPE="foreign" FIELDS="gmdl_id_usuario" REFTABLE="gmdl_usuario" REFFIELDS="mdl_id_usuario"/>
        <KEY NAME="gmdl_id_logro" TYPE="foreign" FIELDS="gmdl_id_logro" REFTABLE="gmdl_logro" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="gmdl_id_usuario-gmdl_id_logro" UNIQUE="true" FIELDS="gmdl_id_usuario, gmdl_id_logro"/>
      </INDEXES>
    </TABLE>
  </TABLES>
</XMLDB>