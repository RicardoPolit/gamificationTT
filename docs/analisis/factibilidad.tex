
\section{Estudio de factibilidad de implementación sobre moodle}


\subsection{Extensión del esquema de base de datos}

 Moodle cuenta con su propio lenguaje de definición de datos (DDL, Data Definition
 Language), y lenguaje de manipulación de datos (DML, Data Management Language), que añaden
 una capa de abstracción independiente del sistema gestor de base de datos que se este
 utilizando. Moodle tiene soporte para funcionar sobre bases de datos MySQL, PostgresSQL,
 MariaDB, MSSQL y Oracle \cite{moodleInstall}.

\subsubsection{Pautas de Moodle para la base de datos}

    %[] https://www.oreilly.com/library/view/high-performance-mysql/9781449332471/
Moodle permite extender su esquema de base de datos mediante la instalación de plugins. Esto no solo nos lleva a conocer y entender su esquema de datos hasta un cierto punto, sino también, nos lleva a apegarnos a las restricciones que impone Moodle para la creación de la base de datos de los componentes.\\

    \noindent Tampoco hay que olvidar lo que significa el desarrollo de componentes, ya que, deben permitirle al usuario instalarlos y desinstalarlos cuando ella quiera y no tener ningún tipo de problema en su plataforma de Moodle, es decir, los componentes deben tener un bajo acoplamiento \cite[pp. 244-245]{defAcoplamiento} con Moodle.\\

    \noindent Moodle presenta varias pautas a seguir \cite{moodlePautasBD1},\cite{ moodlePautasBD2}, donde el público objetivo de las mismas es muy amplio. Por ello a continuación se presentan las pautas consideradas más relevantes e importantes.
    
\subsection{Pautas en tablas y atributos}
    \begin{enumerate}
        \item Cada tabla debe tener como llave primaria un atributo llamado ''id'' de tipo entero con una longitud de 10 dígitos que sea auto-incremental.
        \item Si se está desarrollando un componente que es una actividad para un curso, el esquema del componente deberá tener una tabla principal que lleve el mismo nombre que el componente y dicha tabla deberá contener como mínimo los siguientes campos: el principal anteriormente explicado ''id', una referencia al curso ''course'' y un nombre ''name''.
        %\item Además del punto anterior, toda tabla que contenga información extra o relacionada con la actividad, por ejemplo preguntas de un examen, deberá llamarse (nombre de la actividad)\_(información extra), dicha información extra deberá estar en plural. Siguiendo con el ejemplo seria; examen\_preguntas.
        %\item Las tablas deberán tener un nombre en singular, exceptuando el ejemplo anterior o uno que defina la misma estructura.
        \item Los nombres de atributos y tablas deberán estar en minúsculas y el único carácter especial que se puede usar en ellos es el guión bajo.
        \item El nombre de las llaves deberá tener los nombres de los campos que se utiliza para crearlas (Excluyendo los atributos de otras tablas). Dichos nombres deberán ser separados por el signo menos ''-''.
        \item Se recomienda que el nombre de las tablas no pase de 28 caracteres
        \item Se recomienda que el nombre de los atributos no exceda los 30 caracteres.
        \item Los atributos que hacen referencia a otra tabla deberán tener el nombre de la tabla a la que hace referencia y la palabra ''id'' en su nombre. Por ejemplo, la\_otra\_tabla\_id.
        \item Solo se definirá un atributo como llave única (UNIQUE KEY), si este es apuntado por otro atributo, ya sea en la misma o en otra tabla con una llave foránea (FOREIGN KEY).
        \item No se deben de usar vistas, debido a que no existe soporte para ellas.
        \item Si se quiere tener un valor único no se deben usar llaves únicas (UNIQUE KEY), se recomienda utilizar en su lugar un índice único (UNIQUE INDEX)
    \end{enumerate}

\subsection{Pautas en tipos de datos}

         Moodle establece la relación entre sus tipos de datos -los cuales se ingresan en el XMLDB Editor- y los tipos de dato que se guardan en los distintos gestores de base de datos \cite{moodleTiposBD}.  Gracias a esto, existen nuevas restricciones:
        \begin{enumerate}
            \item El tipo de dato de fecha, es guardado como un número entero de 10 dígitos ( int(10) ).
            \item El tamaño indicado para un entero establece el tipo de entero que se usará, esto usando los rangos que tiene cada gestor de base de datos. Por ejemplo: INT(10) = BIGINT en MySQL.
            \item No existe la posibilidad de indicar un número sin signo.
        \end{enumerate}

\clearpage
%\subsection{Instalación}
%\subsection{Block Simple HTML}
%\subsection{XMLCreator}
%\subsection{Events API}
%\subsection{DML API y DDL API}
%\subsection{Javascript AMD}
%\subsection{External Pages}
%\subsection{Forms Validation}
%\subsection{Tables}
%\subsection{AJAX AlongSide Moodle}

\subsection{Estableciendo el entorno de desarrollo}

 Al final de este documento se incluye como anexo el documento que detalla el desarrollo de las pruebas de concepto. A continuación se muestran los resultados de dicho documento.

Para llevar a cabo desarrollo sobre la plataforma moodle recomienda considerar el uso de un entorno de desarrollo integrado o IDE (Integrated Development Environment), para facilitar las tareas de programación. Las opciones que brinda moodle en su documentación son los IDEs: Eclipse, Netbeans y PHPStorm.\\

\noindent La primer prueba fue realizada con Eclipse, se incluyeron los archivos del directorio de moodle como parte del proyecto, lamentablemente, los enlaces a los demás archivos, y la depuración de código arrojaban errores debido a que había archivos que no podía vincular correctamente. Por lo que Eclipse fue descartado posterior a la prueba.

\subsubsection{NetBeans}

Netbeans proporciona un buen soporte a PHP, este IDE tiene integración de un sistema de control de versiones, atajos de teclas, lista de funciones, completación de código, soporte para HTML, CSS y Javascript, renombre de archivos/clases instantáneo, búsqueda rápida, entre otros. \cite{NetBeans}, \cite{moodleNetbeans}
% https://netbeans.org/features/
% https://docs.moodle.org/dev/Setting_up_Netbeans

% En la figura \ref{fig:netbeans} se muestra el entorno instalado con el proyecto de ''moodle'' abierto

\subsubsection{PHPStorm}

PHPStorm es un IDE comercial desarrollado por JetBrains, es considerado uno de los mejores IDE para desarrolladores que trabajan con PHP, tiene características como completación e inspección de código, soporte para PHPUnit, soporte para BeHat, editor de base de datos, depurador, entre otras funcionalidades \cite{PHPStorm},\cite{  moodlePHPStorm}.
% https://www.jetbrains.com/phpstorm/features/
% https://docs.moodle.org/dev/Setting_up_PhpStorm

%En la figura \ref{fig:PHPStorm} se puede ver una captura del IDE con el proyecto con los archivos de Moodle, abierto.\\

\begin{quote}
Finalmente, después de haber realizado la prueba con los  tres IDEs, se eligió a PHPStorm como entorno de desarrollo considerando los siguientes puntos:
    \begin{itemize}
    \item Moodle considera que PHPStorm es uno de los mejores entornos de desarrollo para PHP.
    \item PHPStorm está diseñado desde un inicio para trabajar con PHP, a diferencia de NetBeans que dan soporte a PHP y a otros lenguajes de programación.
    \item PHPStorm tiene soporte para las versiones más recientes para PHP, mientras que NetBeans soporta actualmente hasta la versión 5.6 de PHP.
    %\item Por recomendación de un profesor de la ESCOM, debido a su experiencia como usuario.
    % \item Consultando a algunos docentes nos recomendaron utilizar PHPStorm.
    %\item Se cuenta con una licencia gratis por pertenecer al IPN/ESCOM.
    \item El equipo de desarrollo en proyectos anterior ha utilizado anteriormente herramientas de JetBrains y se ha tenido una experiencia agradable. % Android Studio
    \end{itemize}
\end{quote}

\subsection{Desarrollo de las pruebas}

    De los 54 plugins listados en la sección \hyperrefx{subsec:plugins} se decidió priorizar el desarrollo de aquellos tipos de plugins que nos permitieran extender el esquema de base de datos de moodle, y de aquellos que nos permitieran desplegar la información en la interfaz de usuario, razón por la cual se realizaron las pruebas de concepto de los tipos de plugins Database Fields, Database Presets, User Profile Fields, y Blocks.\\

    \noindent A continuación el cuadro \ref{tbl:pruebasC} resume el propósito de cada prueba y los resultados obtenidos.

    \addtable{|c|p{0.30\textwidth}|p{0.45\textwidth}|}{tbl:pruebasC}{
        {\bf Tipo de\par Plugin} & {\bf Objetivo} & {\bf Resultados} \\\hline

        Database Fields &
            Saber si este plugin nos ayudaría a guardar valores en la base de datos, y si fuera capaz, saber la forma en que lo hace. &

            Database Fields nos permite, en caso de que requiriéramos crear un nuevo tipo de dato, que puede ser usado mediante el plugin ''Database Presets''. \\\hline

        Database Presets &
            Saber si este plugin nos permite modificar el esquema de la base de datos, y si fuera capaz, saber la forma en que lo hace. &

            Database Presets nos permite crear y guardar datos en la base de datos, las restricciones es que únicamente nos permite definir formularios. El plugin puede ser usado a  nivel plataforma o a nivel curso. \\\hline

        User Profile Fields &
            Saber si este plugin nos permite guardar valores relacionados al usuario, en la base de datos. &

            User Profile Fields permite crear nuestro propio tipo de dato y agregarlo como un campo más a los datos que el usuario debe introducir. Al incluirse un plugin de este tipo todos los usuarios de la plataforma podrán editar el dato especificado por este plugin. \\\hline

        Blocks &
            Ver cómo desplegar información mediante el uso de este tipo de plugin y asegurar que un mismo block se pueda ver en las vistas principales de la plataforma. &

            Los block/blocks pueden ser instanciados más de una vez y están ligados al usuario.\newline
            Cada plugin puede definir su propio esquema de tablas, atributos e índices.\newline
            Los plugins pueden habilitar/deshabilitar configuraciones generales para el administrador o locales para el usuario. \newline
            Un plugin puede suscribir una clase para capturar los eventos que arroja moodle. \\\hline

    }{Objetivos y resultados de las pruebas de concepto realizadas}
